{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block branding %}
<h1 id="site-name"><a href="{% url 'admin:index' %}">{{ site_header|default:_('Django administration') }}</a></h1>
{% endblock %}

{% block nav-global %}{% endblock %}

{% block content %}
<div class="module filtered" id="changelist">
    <div class="results">
        <div class="module">
            <h2>{{ title }}</h2>
            
            <!-- آمار کلی -->
            <div class="form-row" style="margin-bottom: 20px;">
                <p><strong>تعداد کل امبدینگ‌ها:</strong> {{ total_count }}</p>
                <p>
                    <a href="/admin/embeddings/manage/" class="btn btn-secondary" style="background-color: #6c757d; color: white; text-decoration: none; padding: 8px 16px; border-radius: 4px; margin-right: 10px;">
                        ← بازگشت به مدیریت امبدینگ‌ها
                    </a>
                </p>
            </div>

            <!-- جدول امبدینگ‌ها -->
            {% if embeddings %}
            <div class="results">
                <table id="result_list">
                    <thead>
                        <tr>
                            <th scope="col">شناسه</th>
                            <th scope="col">نوع محتوا</th>
                            <th scope="col">شیء</th>
                            <th scope="col">مدل</th>
                            <th scope="col">بعد بردار</th>
                            <th scope="col">تاریخ ایجاد</th>
                            <th scope="col">متن (خلاصه)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for embedding in embeddings %}
                        <tr class="{% cycle 'row1' 'row2' %}">
                            <td>{{ embedding.id|truncatechars:8 }}...</td>
                            <td>{{ embedding.content_type.name }}</td>
                            <td>
                                {% if embedding.content_object %}
                                    {{ embedding.content_object|truncatechars:30 }}
                                {% else %}
                                    <em>حذف شده</em>
                                {% endif %}
                            </td>
                            <td>{{ embedding.model_name|default:embedding.model_id }}</td>
                            <td>{{ embedding.dim }}</td>
                            <td>{{ embedding.created_at|date:"Y/m/d H:i" }}</td>
                            <td>{{ embedding.text_content|truncatechars:50 }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            {% if embeddings.has_other_pages %}
            <div class="paginator">
                <span class="step-links">
                    {% if embeddings.has_previous %}
                        <a href="?page=1">&laquo; اول</a>
                        <a href="?page={{ embeddings.previous_page_number }}">قبلی</a>
                    {% endif %}

                    <span class="current">
                        صفحه {{ embeddings.number }} از {{ embeddings.paginator.num_pages }}
                    </span>

                    {% if embeddings.has_next %}
                        <a href="?page={{ embeddings.next_page_number }}">بعدی</a>
                        <a href="?page={{ embeddings.paginator.num_pages }}">آخر &raquo;</a>
                    {% endif %}
                </span>
            </div>
            {% endif %}

            {% else %}
            <div class="form-row">
                <p>هیچ امبدینگی یافت نشد.</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
#result_list {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
}

#result_list th,
#result_list td {
    padding: 8px 12px;
    text-align: right;
    border-bottom: 1px solid #ddd;
}

#result_list th {
    background-color: #f8f9fa;
    font-weight: bold;
    border-bottom: 2px solid #dee2e6;
}

.row1 {
    background-color: #fff;
}

.row2 {
    background-color: #f9f9f9;
}

.btn {
    display: inline-block;
    font-weight: 400;
    text-align: center;
    vertical-align: middle;
    user-select: none;
    border: 1px solid transparent;
    padding: 0.375rem 0.75rem;
    font-size: 1rem;
    line-height: 1.5;
    border-radius: 0.25rem;
    transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    cursor: pointer;
    text-decoration: none;
}

.btn:hover {
    opacity: 0.8;
}

.btn-secondary {
    color: #fff;
    background-color: #6c757d;
    border-color: #6c757d;
}

.paginator {
    margin-top: 20px;
    text-align: center;
}

.step-links a {
    margin: 0 5px;
    padding: 5px 10px;
    background-color: #007cba;
    color: white;
    text-decoration: none;
    border-radius: 3px;
}

.step-links a:hover {
    background-color: #005a87;
}

.step-links .current {
    margin: 0 10px;
    font-weight: bold;
}
</style>
{% endblock %}
