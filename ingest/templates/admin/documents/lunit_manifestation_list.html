{% extends "admin/base_site.html" %}
{% load i18n static ingest_jalali %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label='documents' %}">Ø§Ø³Ù†Ø§Ø¯</a>
    &rsaquo; Ø§Ø³Ù†Ø§Ø¯ Ø­Ù‚ÙˆÙ‚ÛŒ
</div>
{% endblock %}

{% block content %}
<div id="content-main">
    <!-- Search Filter Bar -->
    <div style="background: #f8f9fa; border: 1px solid #ddd; border-radius: 6px; padding: 15px; margin-bottom: 20px;">
        <form method="get" action="" style="display: flex; align-items: center; gap: 10px;">
            <label for="search-title" style="font-weight: bold; color: #333; white-space: nowrap;">Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¹Ù†ÙˆØ§Ù†:</label>
            <input 
                type="text" 
                id="search-title" 
                name="q" 
                value="{{ search_query|default:'' }}" 
                placeholder="Ø¹Ù†ÙˆØ§Ù† Ø³Ù†Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."
                style="flex: 1; padding: 8px 12px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px;"
            >
            <button type="submit" style="padding: 8px 20px; background: #417690; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                ğŸ” Ø¬Ø³ØªØ¬Ùˆ
            </button>
            {% if search_query %}
            <a href="?" style="padding: 8px 20px; background: #dc3545; color: white; border-radius: 4px; text-decoration: none; font-weight: bold; white-space: nowrap;">
                âœ– Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†
            </a>
            {% endif %}
        </form>
        {% if search_query %}
        <div style="margin-top: 10px; color: #666; font-size: 13px;">
            Ù†ØªØ§ÛŒØ¬ Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø±Ø§ÛŒ: <strong>"{{ search_query }}"</strong>
            {% if manifestations %}
                - {{ manifestations|length }} Ø³Ù†Ø¯ ÛŒØ§ÙØª Ø´Ø¯
            {% else %}
                - Ù‡ÛŒÚ† Ø³Ù†Ø¯ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯
            {% endif %}
        </div>
        {% endif %}
    </div>
    
    <div class="module" style="margin: 20px 0;">
        {% if manifestations %}
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f5f5f5; border-bottom: 1px solid #ddd;">
                    <th style="padding: 12px; text-align: right; font-weight: bold;">Ø¹Ù†ÙˆØ§Ù† Ø³Ù†Ø¯</th>
                    <th style="padding: 12px; text-align: center; font-weight: bold; width: 150px;">ØªØ¹Ø¯Ø§Ø¯ Ø¨Ù†Ø¯Ù‡Ø§</th>
                    <th style="padding: 12px; text-align: center; font-weight: bold; width: 150px;">ØªØ§Ø±ÛŒØ® ØªØµÙˆÛŒØ¨</th>
                </tr>
            </thead>
            <tbody>
                {% for manifestation in manifestations %}
                <tr style="border-bottom: 1px solid #eee; {% cycle 'background: #fff;' 'background: #f9f9f9;' %}">
                    <td style="padding: 12px; font-weight: normal; font-size: 13px;">
                        <a href="?manifestation__id__exact={{ manifestation.id }}" 
                           style="color: #417690; text-decoration: none; font-weight: 500;">
                            {% if manifestation.expr and manifestation.expr.work %}
                                {{ manifestation.expr.work.title_official }}
                            {% else %}
                                Ø³Ù†Ø¯ #{{ manifestation.id }}
                            {% endif %}
                        </a>
                        {% if manifestation.expr and manifestation.expr.work and manifestation.expr.work.title_short %}
                            <br>
                            <span style="color: #666; font-size: 12px;">{{ manifestation.expr.work.title_short }}</span>
                        {% endif %}
                    </td>
                    <td style="padding: 12px; text-align: center;">
                        <span style="display: inline-block; background: #e3f2fd; color: #1976d2; padding: 4px 12px; border-radius: 12px; font-weight: bold;">
                            {{ manifestation.legalunit_count }}
                        </span>
                    </td>
                    <td style="padding: 12px; text-align: center; color: #666;">
                        {% if manifestation.publication_date %}
                            {{ manifestation.publication_date|jalali_date }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div style="padding: 40px; text-align: center; color: #999;">
            <p style="font-size: 16px;">Ù‡ÛŒÚ† Ø³Ù†Ø¯ Ø­Ù‚ÙˆÙ‚ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
